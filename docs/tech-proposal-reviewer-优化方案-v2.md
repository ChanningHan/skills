# tech-proposal-reviewer Skill 优化方案

## 一、背景

### 1.1 优化目标

基于当前 Skill 的使用情况和反馈，识别出以下核心问题，需要通过优化提升 Skill 的灵活性、可配置性和实用性：

1. **角色区分度不足**：两个前端专家角色定义完全相同，没有差异化
2. **评分标准不明确**：缺少明确的评分标准，可能导致评分不一致
3. **角色选择不灵活**：角色固定，无法根据方案类型智能选择或生成新角色
4. **评审结果展示单一**：缺少可视化的展示方式，不利于快速理解评审结果
5. **缺少场景化模板**：不同场景的评审重点不同，但只有一个通用模板

### 1.2 Skill 命名优化建议

当前 Skill 名称为 `tech-proposal-reviewer`，考虑到该 Skill 通过不同的评审模板和评审角色的组合，可以适用于各种各样的方案评审（不仅限于技术方案），建议重命名为更具通用性的名称。

**推荐命名**：`proposal-reviewer`

**理由**：
- 符合 OpenSkills 命名规范（kebab-case）
- 更具通用性，不局限于技术方案
- 简洁明了，易于理解和记忆
- 与现有命名风格保持一致

**命名变更影响**：
- Skill 目录名：`tech-proposal-reviewer` → `proposal-reviewer`
- Front matter 中的 name 字段需要更新
- README.md 和 AGENTS.md 中的引用需要更新

### 1.2 优化原则

- **渐进式优化**：优先解决高优先级问题，逐步完善
- **向后兼容**：保持现有功能不变，新增功能作为可选配置
- **文档驱动**：继续采用文档驱动方式，不引入代码依赖

## 二、优化内容

### 2.1 角色定义优化（高优先级）

**问题**：两个前端专家角色定义完全相同，评审时可能产生重复意见。

**优化方案**：
- **前端专家 1**：侧重架构设计、性能优化、技术选型
  - 关注点：系统架构、性能瓶颈、技术选型合理性、扩展性
- **前端专家 2**：侧重代码质量、可维护性、工程化实践
  - 关注点：代码规范、测试覆盖、CI/CD、文档完整性、团队协作

**实施位置**：`SKILL.md` 中的"角色定义与评审指南"章节

### 2.2 评分标准明确化（高优先级）

**问题**：评分标准不明确，不同 Agent 可能对同一方案给出不同评分。

**优化方案**：
添加"评分标准定义"章节，为每个评分等级提供明确的判断标准：

- **5 分（优秀）**：无明显问题，设计合理，可直接实施
- **4 分（良好）**：有少量改进空间，但不影响核心功能
- **3 分（一般）**：存在需要关注的问题，建议优化后再实施
- **2 分（较差）**：存在较多问题，需要重大改进
- **1 分（很差）**：存在严重问题，不建议实施

为每个评审维度提供评分参考标准（示例）。

**实施位置**：`SKILL.md` 中新增"评分标准定义"章节

### 2.3 角色抽象与智能选择（中优先级）

**问题**：角色和评审维度固定，不够灵活。不同技术方案可能需要不同的评审角色，但当前 Skill 只提供了固定的角色列表。

**优化方案**：
1. **抽象角色定义结构**：
   - 定义角色的核心要素：角色定位、关注领域、评审维度
   - 提供角色定义的模板和规范
   - 说明如何定义一个新角色

2. **智能角色选择机制**：
   - Agent 根据技术方案的类型和内容，智能决策需要哪些角色进行评审
   - 提供角色选择指导原则（如：前端方案需要前端专家，数据库方案需要数据库专家）
   - 支持 Agent 根据方案特点动态选择角色

3. **角色生成能力**：
   - 允许 Agent 在特殊场景下"生成"一个 Skill 中不存在的角色来进行评审
   - 核心是定义这个角色的评审关注点和专业方向
   - 提供角色生成的原则和示例

**实施位置**：`SKILL.md` 中新增"角色抽象与智能选择"章节，更新"角色定义与评审指南"章节

**重要说明：角色定义与评审模板的关系**

角色定义和评审模板是互补关系，不会冲突：
- **角色定义**：定义"谁评审"，关注评审者的专业视角、关注领域、评审维度
- **评审模板**：定义"评审什么"，关注评审内容结构、检查清单、报告格式

设计原则：
- 模板包含"推荐角色组合"，而非固定角色
- 角色定义应抽象化，可被不同模板复用
- 模板可以指定"重点关注维度"，但不限制角色选择
- Agent 可以根据方案特点，结合模板推荐和实际情况，灵活选择或生成角色

### 2.4 评审结果可视化（中优先级）

**问题**：当前评审报告以纯文本 Markdown 格式输出，缺少可视化的展示方式，不利于快速理解评审结果和趋势分析。

**优化方案**：
1. **评审结果可视化格式**：
   - 提供多种可视化展示方式：评分雷达图、评分对比图、问题分布图等
   - 支持生成可视化的评审摘要（如评分卡片、关键问题高亮）
   - 提供结构化的数据格式（JSON），便于后续可视化处理

2. **可视化内容设计**：
   - **评分可视化**：各角色、各维度的评分对比图表
   - **问题分布可视化**：按严重程度、类别分类的问题分布图
   - **改进建议优先级可视化**：行动项的优先级和依赖关系图
   - **评审趋势可视化**：多次评审的对比分析（如适用）

3. **可视化实现方式**：
   - **输出结构**：生成一个文件夹，文件夹命名包含方案名称和唯一标识符（如时间戳），避免重名：
     ```
     review-{方案名称}-{时间戳}/
     例如：review-api-design-20250127-143022/
     ├── data.json              # 结构化评审数据（JSON 格式）
     ├── report.md              # Markdown 格式报告
     ├── report.html            # HTML 格式报告（可视化）
     └── assets/                 # 静态资源（如需要）
         └── charts/
     ```
   - **生成流程**：
     1. Agent 生成 JSON 数据文件（包含完整的评审数据）
     2. 使用 JavaScript 脚本基于模板生成 MD 和 HTML 文件
     3. 脚本放在 `scripts/` 目录，Agent 可调用
   - **模板系统**：
     - Markdown 模板：`references/markdown-template.md`
     - HTML 模板：`references/html-template.html`
     - JSON 数据结构说明：`references/json-schema.md`（文档说明）
   - **脚本设计**：
     - `scripts/generate-markdown.js` - 基于 JSON 数据和模板生成 Markdown 文件
     - `scripts/generate-html.js` - 基于 JSON 数据和模板生成 HTML 文件
     - 输入：`data.json`、对应模板文件
     - 输出：`report.md`（generate-markdown.js）、`report.html`（generate-html.js）
     - 模板引擎：使用 Handlebars 或 Mustache（JavaScript 常用模板引擎）

**实施位置**：`SKILL.md` 中新增"评审结果可视化"章节，更新"评审报告格式"章节，新增可视化模板和脚本到对应目录

### 2.5 评审模板库与多场景适配（中优先级）

**问题**：不同场景的方案评审重点不同，但当前只有一个通用模板，缺少针对性的评审模板。此外，一个方案可能同时涉及多个场景（如 API 设计 + 数据库设计），需要支持模板组合使用。适用场景描述简单，缺少针对性指导。

**优化方案**：
1. **场景化评审模板**：
   - 为不同场景提供专门的评审模板
   - 每个模板包含该场景的评审重点和检查清单
   - 模板包含推荐的角色组合和评审维度（非强制，Agent 可根据实际情况调整）
   - 为每个场景提供评审重点清单，说明哪些角色和维度更重要

2. **模板分类与适用场景说明**：
   - **技术方案设计评审模板**：通用技术方案评审
   - **架构设计评审模板**：系统架构评审
   - **API 设计评审模板**：接口设计评审
   - **数据库设计评审模板**：数据模型评审
   - **产品功能方案评审模板**：功能方案评审
   - **系统升级改造方案评审模板**：改造方案评审
   - 扩展适用场景说明，整合到"概述"章节

3. **模板选择说明文档**：
   - 创建 `references/template-selection-guide.md` 说明文档
   - 指导 Agent 如何根据方案类型和内容选择合适的模板
   - 说明不同场景对应的模板文件
   - 说明如何识别方案涉及的多个场景
   - 提供模板组合使用的指导原则（非代码实现，而是说明文档）

4. **模板组合使用机制**：
   - **单模板模式**：适用于单一场景的方案（如纯 API 设计）
   - **组合模板模式**：适用于复合场景的方案（如 API + 数据库设计）
     - Agent 识别方案涉及的多个场景
     - 选择对应的多个模板
     - 合并模板的评审重点和检查清单
     - 去重并整合角色推荐
   - **模板冲突处理**：当多个模板对同一维度有不同要求时，采用更严格的标准
   - **模板优先级**：定义模板的优先级规则，指导 Agent 选择

5. **模板使用指南**：
   - 说明如何选择合适的模板（参考模板选择说明文档）
   - 说明如何组合使用多个模板
   - 提供模板的自定义方法
   - 说明模板与通用评审流程的关系
   - 说明模板与角色定义的关系（模板推荐角色，但不限制角色选择）

**实施位置**：`SKILL.md` 中新增"评审模板库"章节（包含场景说明和模板使用指南），在 `references/templates/` 目录下新增各场景的评审模板文件，新增 `references/template-selection-guide.md` 说明文档，更新"概述"章节（整合场景说明）

## 三、实施步骤

### 第一阶段：核心优化（高优先级，预期时间：1-2 小时）

- [ ] 修改 Skill 名称：`tech-proposal-reviewer` → `proposal-reviewer`
- [ ] 优化角色定义：区分两个前端专家的关注点，更新角色定义章节
- [ ] 添加评分标准：创建评分标准定义章节，为每个评审维度提供评分参考

### 第二阶段：功能增强（中优先级，预期时间：3-4 小时）

- [ ] 角色抽象与智能选择：抽象角色定义结构，添加智能角色选择机制，支持角色生成能力
- [ ] 评审结果可视化：设计 JSON 数据结构，创建 Markdown/HTML 模板，开发脚本工具（generate-markdown.js、generate-html.js），集成模板引擎，编写使用说明
- [ ] 评审模板库与多场景适配：创建场景化评审模板（架构、API、数据库、产品功能、系统升级等），扩展适用场景说明，编写模板使用指南（含组合使用说明），提供模板选择指导，整合场景说明到概述章节

## 四、文件变更清单

### 4.1 需要修改的文件

1. **`skills/proposal-reviewer/SKILL.md`**
   - 优化角色定义（前端专家 1 和 2）
   - 新增"评分标准定义"章节
   - 新增"角色抽象与智能选择"章节（包含角色与模板关系的说明）
   - 更新"角色定义与评审指南"章节（抽象角色定义结构）
   - 新增"评审结果可视化"章节（包含输出结构和脚本说明）
   - 更新"评审报告格式"章节（添加可视化支持）
   - 新增"评审模板库"章节（包含场景说明、模板组合使用机制）
   - 更新"概述"章节（整合场景说明）

2. **`skills/proposal-reviewer/references/review-template.md`**
   - 优化模板格式
   - 增加评审摘要部分

3. **`skills/proposal-reviewer/references/markdown-template.md`**（新增）
   - Markdown 报告模板
   - 支持 Mermaid 图表嵌入
   - 使用 Handlebars/Mustache 模板语法

4. **`skills/proposal-reviewer/references/html-template.html`**（新增）
   - HTML 报告模板
   - 包含可视化图表和样式
   - 使用 Handlebars/Mustache 模板语法

5. **`skills/proposal-reviewer/references/json-schema.md`**（新增）
   - JSON 数据结构说明文档
   - 数据字段定义和示例

6. **`skills/proposal-reviewer/references/template-selection-guide.md`**（新增）
   - 模板选择说明文档
   - 指导 Agent 如何根据方案类型选择合适的模板
   - 说明模板组合使用的原则

7. **`skills/proposal-reviewer/references/templates/`**（新增目录）
   - `architecture-review-template.md` - 架构设计评审模板
   - `api-review-template.md` - API 设计评审模板
   - `database-review-template.md` - 数据库设计评审模板
   - `product-feature-review-template.md` - 产品功能方案评审模板
   - `system-upgrade-review-template.md` - 系统升级改造方案评审模板
   - `general-proposal-review-template.md` - 通用技术方案评审模板

8. **`skills/proposal-reviewer/scripts/generate-markdown.js`**（新增）
   - 基于 JSON 数据和模板生成 Markdown 报告
   - 使用 Handlebars 或 Mustache 模板引擎
   - 输入：`data.json`、`markdown-template.md`
   - 输出：`report.md`
   - 包含使用说明和示例

9. **`skills/proposal-reviewer/scripts/generate-html.js`**（新增）
   - 基于 JSON 数据和模板生成 HTML 报告
   - 使用 Handlebars 或 Mustache 模板引擎
   - 输入：`data.json`、`html-template.html`
   - 输出：`report.html`
   - 包含使用说明和示例

8. **`skills/proposal-reviewer/examples/sample-review-report.md`**（可选）
   - 根据新的评分标准更新示例
   - 展示不同场景模板的使用效果
   - 展示模板组合使用的示例

### 4.2 命名变更（如采用建议）

如果采用 `proposal-reviewer` 命名：
- Skill 目录重命名：`tech-proposal-reviewer` → `proposal-reviewer`
- 更新 `SKILL.md` frontmatter 中的 name 字段
- 更新 `README.md` 和 `AGENTS.md` 中的引用

## 五、风险评估

### 5.1 兼容性风险

**风险**：优化后的 Skill 可能与现有使用方式不兼容。

**应对措施**：
- 保持现有功能不变，新增功能作为可选配置
- 默认行为与当前版本一致
- 提供迁移指南（如有必要）

### 5.2 复杂度增加风险

**风险**：优化后 Skill 文档变长，可能影响 Agent 理解。

**应对措施**：
- 采用清晰的章节结构
- 使用目录导航
- 保持文档的可读性

### 5.3 实施风险

**风险**：优化内容较多，可能遗漏某些细节。

**应对措施**：
- 分阶段实施，逐步验证
- 每个阶段完成后进行测试
- 保持文档与代码的一致性

## 六、预期效果

### 6.1 短期效果

- 评审结果更加准确和一致（评分标准明确化）
- 角色评审更有区分度（角色定义优化）
- 评审流程更加清晰（流程增强）

### 6.2 长期效果

- 支持更多使用场景（评审模板库，包含场景说明和模板组合）
- 更灵活的角色选择机制（智能选择、角色生成，与模板解耦）
- 更好的可扩展性（角色抽象设计、模板系统）
- 更直观的评审结果展示（多格式输出：JSON、MD、HTML）
- 更高效的评审流程（场景化模板、模板组合使用）
- 更通用的 Skill 定位（通过命名优化，适用于各类方案评审）

## 七、后续优化方向

1. **评审自动化工具**：提供脚本工具辅助 Agent 执行评审
2. **评审结果分析**：提供评审结果的统计和分析功能（如多次评审的对比分析）
3. **评审知识库**：积累常见问题和最佳实践
4. **多语言支持**：支持英文等其他语言的评审
5. **可视化工具增强**：提供更丰富的可视化图表类型和交互式展示

---
